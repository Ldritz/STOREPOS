import{r as Y,j as e}from"./vendor-react-DYaHPGH9.js";import{C as p}from"./Card-CJQhyZQC.js";import{T as N,a as k,b as S,W as $,P as z}from"./index-75GWciUF.js";import{R as L,P as H,a as K,C as X,T,L as D,b as F,c as q,X as G,Y as U,d as w}from"./vendor-recharts-BPI4yfYo.js";import"./vendor-B_ioZ_iA.js";import"./vendor-firebase-Bk-C1n0P.js";const _=({data:r})=>{const o=t=>`₱${t.toLocaleString()}`;return e.jsx("div",{className:"w-full h-72 md:h-80",children:e.jsx(L,{children:e.jsxs(F,{data:r,margin:{top:20,right:30,left:0,bottom:5},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",horizontal:!0,vertical:!1}),e.jsx(G,{dataKey:"name",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(U,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickFormatter:o,tickLine:!1,axisLine:!1}),e.jsx(T,{cursor:{stroke:"hsl(var(--border))",strokeWidth:1.5,strokeDasharray:"3 3"},contentStyle:{backgroundColor:"hsl(var(--popover))",borderColor:"hsl(var(--border))",borderRadius:"0.5rem",color:"hsl(var(--popover-foreground))"},labelStyle:{fontWeight:"bold"}}),e.jsx(D,{wrapperStyle:{color:"hsl(var(--foreground))",paddingTop:"10px"}}),e.jsx(w,{type:"monotone",dataKey:"income",stroke:"hsl(var(--success))",strokeWidth:2.5,name:"Income",dot:!1,activeDot:{r:6,strokeWidth:2,fill:"hsl(var(--background))",stroke:"hsl(var(--success))"}}),e.jsx(w,{type:"monotone",dataKey:"expense",stroke:"hsl(var(--warning))",strokeWidth:2.5,name:"Expense",dot:!1,activeDot:{r:6,strokeWidth:2,fill:"hsl(var(--background))",stroke:"hsl(var(--warning))"}})]})})})},I=({title:r,amount:o,Icon:t,iconClass:a,isToday:n})=>e.jsxs("div",{className:"bg-card border border-border p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:r}),e.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-foreground mt-1",children:o.toLocaleString("en-PH",{style:"currency",currency:"PHP"})}),n&&o===0&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"No transactions for today yet."})]}),e.jsx("div",{className:`p-3 rounded-md ${a}`,children:e.jsx(t,{className:"w-8 h-8"})})]}),B=({inventory:r,onNavigate:o})=>{const t=r.filter(n=>n.stock<=5&&!n.isDisabled),a=t.length>0;return e.jsx(p,{title:"Low Stock Alerts",className:a?"animate-flash-warning":"",actions:e.jsx("button",{onClick:()=>o(z.Inventory),className:"text-sm text-primary font-semibold hover:underline",children:"Manage →"}),children:a?e.jsx("div",{className:"h-72 overflow-y-auto pr-2",children:e.jsx("ul",{className:"space-y-2",children:t.slice(0,5).map(n=>e.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-secondary rounded-md",children:[e.jsx("span",{className:"text-secondary-foreground",children:n.name}),e.jsxs("span",{className:"font-bold text-destructive",children:[n.stock," ",n.unit," left"]})]},n.id))})}):e.jsxs("div",{className:"text-center text-muted-foreground h-72 flex flex-col justify-center items-center",children:[e.jsx("p",{className:"font-semibold",children:"No low stock items."}),e.jsx("p",{className:"text-sm",children:"Well done!"})]})})},C=["hsl(var(--info))","hsl(var(--success))","hsl(var(--warning))","hsl(var(--destructive))","hsl(260, 70%, 60%)"],J=({data:r})=>{const o=t=>`₱${t.toLocaleString()}`;return e.jsx(p,{title:"Top 5 Products by Revenue",children:e.jsx("div",{className:"w-full h-72",children:r.length>0?e.jsx(L,{children:e.jsxs(H,{children:[e.jsx(K,{data:r,cx:"50%",cy:"45%",labelLine:!1,outerRadius:"80%",fill:"#8884d8",dataKey:"revenue",nameKey:"name",children:r.map((t,a)=>e.jsx(X,{fill:C[a%C.length],stroke:"hsl(var(--background))",strokeWidth:2},`cell-${a}`))}),e.jsx(T,{contentStyle:{backgroundColor:"hsl(var(--popover))",borderColor:"hsl(var(--border))",borderRadius:"0.5rem",color:"hsl(var(--popover-foreground))"},formatter:t=>[typeof t=="number"?o(t):t,"Revenue"]}),e.jsx(D,{iconSize:12,layout:"horizontal",verticalAlign:"bottom",align:"center",wrapperStyle:{color:"hsl(var(--foreground))",fontSize:"14px",paddingTop:"20px"}})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground text-center",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"No sales data available."}),e.jsx("p",{className:"text-sm",children:"Sell some products to see top performers!"})]})})})})},f=({title:r,amount:o,Icon:t,iconClass:a})=>e.jsxs("div",{className:"bg-card border border-border p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium uppercase",children:r}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:o.toLocaleString("en-PH",{style:"currency",currency:"PHP"})})]}),e.jsx("div",{className:`p-3 rounded-md ${a}`,children:e.jsx(t,{className:"w-6 h-6"})})]}),re=({transactions:r,inventory:o,onNavigate:t})=>{const{todaysIncome:a,todaysExpenses:n,totalIncome:E,totalExpenses:P,netIncome:O,chartData:g,topProductsData:A}=Y.useMemo(()=>{const R=new Date().toISOString().split("T")[0];let j=0,v=0,u=0,h=0;const l={},y=new Date;for(let s=5;s>=0;s--){const d=new Date(y.getFullYear(),y.getMonth()-s,1).toLocaleString("default",{month:"short",year:"numeric"});l[d]={income:0,expense:0}}const m={};r.forEach(s=>{const i=s.date.startsWith(R);s.type===N.Income?(u+=s.amount,i&&(j+=s.amount),s.items&&s.items.forEach(b=>{const c=o.find(x=>x.id===b.inventoryItemId);if(c){const x=c.price*b.quantity;m[c.id]?m[c.id].revenue+=x:m[c.id]={name:c.name,revenue:x}}})):(h+=s.amount,i&&(v+=s.amount));const d=new Date(s.date).toLocaleString("default",{month:"short",year:"numeric"});l[d]&&(s.type===N.Income?l[d].income+=s.amount:l[d].expense+=s.amount)});const W=Object.keys(l).map(s=>({name:`${new Date(s).toLocaleString("default",{month:"short"})} '${new Date(s).getFullYear().toString().slice(2)}`,...l[s]})),M=Object.values(m).sort((s,i)=>i.revenue-s.revenue).slice(0,5);return{todaysIncome:j,todaysExpenses:v,totalIncome:u,totalExpenses:h,netIncome:u-h,chartData:W,topProductsData:M}},[r,o]);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(I,{title:"TODAY'S INCOME",amount:a,Icon:k,iconClass:"bg-success text-success-foreground",isToday:!0}),e.jsx(I,{title:"TODAY'S EXPENSES",amount:n,Icon:S,iconClass:"bg-warning text-warning-foreground",isToday:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[e.jsx(B,{inventory:o,onNavigate:t}),e.jsx(J,{data:A})]}),e.jsx(p,{title:"Monthly Performance",children:g.length>0?e.jsx(_,{data:g}):e.jsxs("div",{className:"h-full flex flex-col justify-center items-center text-center py-10 text-muted-foreground",children:[e.jsx("p",{className:"font-semibold",children:"No transaction data for chart."}),e.jsx("p",{className:"text-sm",children:"Add some transactions to get started!"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{title:"TOTAL INCOME",amount:E,Icon:k,iconClass:"bg-success text-success-foreground"}),e.jsx(f,{title:"TOTAL EXPENSES",amount:P,Icon:S,iconClass:"bg-warning text-warning-foreground"}),e.jsx(f,{title:"NET INCOME",amount:O,Icon:$,iconClass:"bg-info text-info-foreground"})]})]})};export{re as default};
