import{T as h,j as e,c as L,L as O,C as $,d as H}from"./index-FjrJvk9f.js";import{R as u,r as p}from"./charts-BYcMWlQw.js";import"./vendor-CWc6w16D.js";const i=(a,r=!1)=>(r?Math.abs(a):a).toLocaleString("en-PH",{style:"currency",currency:"PHP"}),N=u.memo(({title:a,value:r,avg:d})=>e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:a}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:i(r)}),d!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["avg ",i(d),"/day"]})]})),S=u.memo(({title:a,stats:r})=>e.jsxs("div",{className:"bg-card border border-border p-4 sm:p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-bold text-card-foreground mb-4",children:a}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(N,{title:`Today's ${a.split(" ")[0]}`,value:r.today}),e.jsx(N,{title:"This Week",value:r.thisWeek,avg:r.avgWeek}),e.jsx(N,{title:"All Time",value:r.allTime,avg:r.avgAllTime})]})]})),P=u.memo(({data:a,sortedDateKeys:r})=>e.jsx("div",{className:"bg-card border border-border rounded-lg overflow-hidden animate-fade-in",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-muted-foreground",children:[e.jsx("thead",{className:"text-xs text-muted-foreground uppercase bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3",children:"Date"}),e.jsx("th",{scope:"col",className:"px-4 py-3 min-w-[250px]",children:"Description"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"Income (Credit)"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"Expense (Debit)"})]})}),e.jsx("tbody",{children:r.length>0?r.map(d=>{const m=a[d];return e.jsxs(u.Fragment,{children:[m.transactions.map((c,g)=>e.jsxs("tr",{className:"border-b border-border hover:bg-muted",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground whitespace-nowrap",children:g===0?new Date(d+"T00:00:00").toLocaleDateString("en-CA"):""}),e.jsx("td",{className:"px-4 py-3",children:c.description}),e.jsx("td",{className:"px-4 py-3 text-right font-mono text-success",children:c.income?i(c.income):"-"}),e.jsx("td",{className:"px-4 py-3 text-right font-mono text-warning",children:c.expense?i(c.expense):"-"})]},c.id)),e.jsxs("tr",{className:"bg-secondary border-b-2 border-border",children:[e.jsx("td",{colSpan:2,className:"px-4 py-2 text-right font-bold text-foreground",children:"Total"}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-success",children:i(m.totalIncome)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-warning",children:i(m.totalExpense)})]})]},d)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"px-4 py-8 text-center text-muted-foreground",children:[e.jsx("p",{className:"font-semibold",children:"No transactions found."}),e.jsx("p",{className:"text-sm",children:"Add some transactions to get started!"})]})})})]})})})),U=u.memo(({transactions:a,onDeleteTransaction:r})=>{const[d,m]=p.useState("cashbook"),[c,g]=p.useState(new Set),{incomeStats:I,expenseStats:C}=p.useMemo(()=>{const s=new Date().toISOString().split("T")[0],o=new Date;o.setDate(o.getDate()-o.getDay());const t=o.toISOString().split("T")[0];let n=0,x=0,f=0,j=0,b=0,y=0;a.forEach(l=>{const T=l.date.startsWith(s),k=l.date>=t;l.type===h.Income?(b+=l.amount,T&&(n+=l.amount),k&&(f+=l.amount)):(y+=l.amount,T&&(x+=l.amount),k&&(j+=l.amount))});const w=7,D=a.length>0?Math.max(1,Math.ceil((new Date().getTime()-new Date(a[a.length-1].date).getTime())/(1e3*60*60*24))):1;return{incomeStats:{today:n,thisWeek:f,allTime:b,avgWeek:f/w,avgAllTime:b/D},expenseStats:{today:x,thisWeek:j,allTime:y,avgWeek:j/w,avgAllTime:y/D}}},[a]),{groupedCashbookData:E,sortedCashbookDateKeys:W}=p.useMemo(()=>{const s={};a.forEach(t=>{const n=t.date;s[n]||(s[n]={transactions:[],totalIncome:0,totalExpense:0});const x={id:t.id,description:t.description,income:t.type===h.Income?t.amount:null,expense:t.type===h.Expense?t.amount:null};s[n].transactions.push(x),t.type===h.Income?s[n].totalIncome+=t.amount:s[n].totalExpense+=t.amount});const o=Object.keys(s).sort((t,n)=>new Date(n).getTime()-new Date(t).getTime());return{groupedCashbookData:s,sortedCashbookDateKeys:o}},[a]),v=p.useMemo(()=>{const s={};return a.forEach(o=>{const t=o.date;s[t]||(s[t]=[]),s[t].push(o)}),Object.entries(s).sort(([o],[t])=>new Date(t).getTime()-new Date(o).getTime()).map(([o,t])=>({date:o,transactions:t.sort((n,x)=>new Date(x.date).getTime()-new Date(n.date).getTime())}))},[a]),M=s=>{const o=new Date(s+"T00:00:00"),t=new Date,n=new Date(t);return n.setDate(n.getDate()-1),o.toDateString()===t.toDateString()?"Today":o.toDateString()===n.toDateString()?"Yesterday":o.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},A=s=>{const o=new Set(c);o.has(s)?o.delete(s):o.add(s),g(o)};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(S,{title:"Income",stats:I}),e.jsx(S,{title:"Expenses",stats:C})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Transaction History"}),e.jsxs("div",{className:"flex bg-secondary rounded-lg p-1",children:[e.jsx("button",{onClick:()=>m("cashbook"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${d==="cashbook"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Cashbook"]})}),e.jsx("button",{onClick:()=>m("list"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${d==="list"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"List"]})})]})]}),d==="cashbook"?e.jsx(P,{data:E,sortedDateKeys:W}):e.jsx("div",{className:"space-y-4",children:v.length>0?v.map(({date:s,transactions:o})=>e.jsxs("div",{className:"bg-card border border-border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:M(s)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.length," transaction",o.length!==1?"s":""]})]}),e.jsx("button",{onClick:()=>A(s),className:"text-muted-foreground hover:text-foreground transition-colors",children:e.jsx($,{className:`w-5 h-5 transition-transform ${c.has(s)?"rotate-180":""}`})})]})}),c.has(s)&&e.jsx("div",{className:"divide-y divide-border",children:o.map(t=>e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:t.description}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(t.date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`font-mono font-bold ${t.type===h.Income?"text-success":"text-warning"}`,children:[t.type===h.Income?"+":"-",i(t.amount,!0)]}),e.jsx("button",{onClick:()=>r(t),className:"text-muted-foreground hover:text-destructive transition-colors p-1",title:"Delete transaction",children:e.jsx(H,{className:"w-4 h-4"})})]})]},t.id))})]},s)):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("p",{className:"font-semibold",children:"No transactions found."}),e.jsx("p",{className:"text-sm",children:"Add some transactions to get started!"})]})})]})});export{U as default};
