const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardPage-s_6jLgKk.js","assets/vendor-react-DYaHPGH9.js","assets/vendor-B_ioZ_iA.js","assets/Card-CJQhyZQC.js","assets/vendor-recharts-BPI4yfYo.js","assets/vendor-firebase-Bk-C1n0P.js","assets/TransactionsPage-BhzN8dnt.js","assets/InventoryPage-DDLFU6xl.js","assets/cloudinary-B-Z19H0V.js","assets/SettingsPage-QR4r4nje.js","assets/AddTransactionModal-DidbAVrw.js","assets/EditTransactionModal-Ccz8-wkY.js","assets/ChangelogModal-DpNsN_D5.js"])))=>i.map(i=>d[i]);
import{j as e,r as m,b as Me,R as Te}from"./vendor-react-DYaHPGH9.js";import{i as Ae,a as De,p as Pe,c as D,o as W,d as y,q as G,b as Y,s as J,g as Oe,w as A,e as K,u as X,f as Fe,h as Re}from"./vendor-firebase-Bk-C1n0P.js";import"./vendor-B_ioZ_iA.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))u(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function h(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function u(l){if(l.ep)return;l.ep=!0;const d=h(l);fetch(l.href,d)}})();const Be="modulepreload",_e=function(t){return"/"+t},Z={},O=function(i,h,u){let l=Promise.resolve();if(h&&h.length>0){let p=function(w){return Promise.all(w.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const x=document.querySelector("meta[property=csp-nonce]"),I=(x==null?void 0:x.nonce)||(x==null?void 0:x.getAttribute("nonce"));l=p(h.map(w=>{if(w=_e(w),w in Z)return;Z[w]=!0;const v=w.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${b}`))return;const c=document.createElement("link");if(c.rel=v?"stylesheet":Be,v||(c.as="script"),c.crossOrigin="",c.href=w,I&&c.setAttribute("nonce",I),document.head.appendChild(c),v)return new Promise((C,M)=>{c.addEventListener("load",C),c.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${w}`)))})}))}function d(p){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=p,window.dispatchEvent(x),!x.defaultPrevented)throw p}return l.then(p=>{for(const x of p||[])x.status==="rejected"&&d(x.reason);return i().catch(d)})};var k=(t=>(t.Dashboard="DASHBOARD",t.Transactions="TRANSACTIONS",t.Inventory="INVENTORY",t.Settings="SETTINGS",t))(k||{}),N=(t=>(t.Income="INCOME",t.Expense="EXPENSE",t))(N||{}),R=(t=>(t.General="GENERAL",t.InventoryPurchase="INVENTORY_PURCHASE",t))(R||{});const z=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"2"})]}),se=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5v14a2 2 0 0 0 2 2h16v-5"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 9v6"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12h6"})]}),re=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 8h-9M4 8h3m4 6V4M8 8v8a4 4 0 004 4h4a4 4 0 004-4V8"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4a2 2 0 100-4 2 2 0 000 4z"})]}),xt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),wt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 9l-6 6M9 9l6 6"})]}),$e=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),vt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L16.732 3.732z"})}),yt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),kt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),jt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 17h8m0 0v-8m0 8l-8-8-4 4-6-6"})}),bt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25-2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 3a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 3V9M3 9a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 9v3m-9 6h2"})}),ae=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),Q=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),It=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),ze=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),We=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),ie=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Lt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),St=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h12A2.25 2.25 0 0120.25 6v12A2.25 2.25 0 0118 20.25H6A2.25 2.25 0 013.75 18V6zM3.75 12h16.5M9 3.75v16.5"})}),Et=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm0 4.5h.007v.008H3.75v-4.5zm0 4.5h.007v.008H3.75v-4.5z"})}),ee=({className:t})=>e.jsxs("svg",{className:t,viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"50",cy:"50",r:"48",fill:"currentColor"}),e.jsx("text",{x:"50",y:"55",fontFamily:"Arial, sans-serif",fontSize:"20",textAnchor:"middle",fill:"#fff",children:"OLESCO"}),e.jsx("text",{x:"50",y:"75",fontFamily:"Arial, sans-serif",fontSize:"14",textAnchor:"middle",fill:"#fff",children:"AGV"})]}),Nt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),Ct=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),Ue=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ve=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Mt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Tt=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),He=({label:t,icon:i,isActive:h,onClick:u})=>e.jsxs("button",{onClick:u,className:`flex flex-col items-center justify-center px-3 py-2 rounded-lg transition-all ${h?"text-primary bg-primary/10 scale-105":"text-muted-foreground hover:text-foreground hover:bg-muted"}`,children:[i,e.jsx("span",{className:"text-xs font-medium mt-1",children:t})]}),qe=({currentPage:t,setCurrentPage:i})=>{const h=[{page:k.Dashboard,label:"Dashboard",icon:e.jsx(z,{className:"w-6 h-6 mb-1"})},{page:k.Transactions,label:"Transactions",icon:e.jsx(se,{className:"w-6 h-6 mb-1"})},{page:k.Inventory,label:"Inventory",icon:e.jsx(re,{className:"w-6 h-6 mb-1"})},{page:k.Settings,label:"Settings",icon:e.jsx(ie,{className:"w-6 h-6 mb-1"})}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-t border-border z-40 safe-bottom pb-[env(safe-area-inset-bottom)] lg:hidden",children:e.jsx("div",{className:"container flex h-16 items-center justify-around max-w-md mx-auto",children:h.map(u=>e.jsx(He,{label:u.label,icon:u.icon,isActive:t===u.page,onClick:()=>i(u.page)},u.page))})})},Ge={apiKey:"AIzaSyBFOBEGWvfdQ_-8TgBtpG1-ccViyTQevSc",authDomain:"olsc-agrifeeds-trading.firebaseapp.com",projectId:"olsc-agrifeeds-trading",storageBucket:"olsc-agrifeeds-trading.appspot.com",messagingSenderId:"188615089972",appId:"1:188615089972:web:e1311c138055bbddfccf61"},Ye=Ae(Ge),f=De(Ye,{localCache:Pe({})});function te(t){const[i,h]=m.useState([]),[u,l]=m.useState(!0),[d,p]=m.useState(null),x=typeof t=="string"?t:JSON.stringify(t);return m.useEffect(()=>{const I=typeof t=="string"?D(f,t):t,w=W(I,v=>{try{const b=v.docs.map(c=>{const C=c.data();return C.date&&typeof C.date.toDate=="function"&&(C.date=C.date.toDate().toISOString()),{id:c.id,...C}});h(b),p(null)}catch(b){console.error("Error processing snapshot: ",b),p(b)}l(!1)},v=>{console.error("Firestore snapshot error: ",v),p(v),l(!1)});return()=>w()},[x]),{data:i,loading:u,error:d}}function Je(t){const[i,h]=m.useState(null),[u,l]=m.useState(!0),[d,p]=m.useState(null);return m.useEffect(()=>{const x=y(f,t),I=W(x,w=>{if(w.exists())try{h({id:w.id,...w.data()}),p(null)}catch(v){console.error("Error processing document snapshot: ",v),p(v)}else h(null);l(!1)},w=>{console.error("Firestore document snapshot error: ",w),p(w),l(!1)});return()=>I()},[t]),{data:i,loading:u,error:d}}const Ke=()=>{const[t,i]=m.useState(!navigator.onLine);return m.useEffect(()=>{const h=()=>i(!1),u=()=>i(!0);return window.addEventListener("online",h),window.addEventListener("offline",u),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",u)}},[]),t?e.jsx("div",{role:"status",className:"w-full bg-warning text-warning-foreground text-center py-2 text-sm font-semibold animate-fade-in sticky top-0 z-50",children:e.jsxs("div",{className:"container flex items-center justify-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),e.jsx("span",{children:"You are currently offline. Changes will sync when you're back online."})]})}):null};function Xe(t,i){const[h,u]=m.useState(()=>{try{const d=window.localStorage.getItem(t);return d?JSON.parse(d):i}catch(d){return console.error(d),i}}),l=d=>{try{const p=d instanceof Function?d(h):d;u(p),window.localStorage.setItem(t,JSON.stringify(p))}catch(p){console.error(p)}};return m.useEffect(()=>{const d=p=>{if(p.key===t&&p.newValue)try{u(JSON.parse(p.newValue))}catch(x){console.error(x)}};return window.addEventListener("storage",d),()=>{window.removeEventListener("storage",d)}},[t]),[h,l]}const Ze="pwa-install-banner-dismissed";function Qe(){const[t,i]=m.useState(null),[h,u]=Xe(Ze,!1);return m.useEffect(()=>{const x=I=>{I.preventDefault(),window.matchMedia("(display-mode: standalone)").matches||i(I)};return window.addEventListener("beforeinstallprompt",x),()=>{window.removeEventListener("beforeinstallprompt",x)}},[]),{shouldShow:!!t&&!h,handleInstall:async()=>{if(!t)return;await t.prompt();const{outcome:x}=await t.userChoice;x==="accepted"&&i(null)},handleDismiss:()=>{u(!0)}}}const et=()=>{const{shouldShow:t,handleInstall:i,handleDismiss:h}=Qe(),u=/Mobi|Android/i.test(navigator.userAgent);return!t||!u?null:e.jsx("div",{role:"alert",className:"fixed bottom-20 right-0 left-0 mx-auto w-[calc(100%-2rem)] max-w-md lg:hidden z-50 animate-slide-in-up",children:e.jsxs("div",{className:"bg-primary text-primary-foreground p-3 rounded-xl shadow-lg flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary-foreground/20 p-2 rounded-lg",children:e.jsx(We,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-sm",children:"Install Olesco POS App"}),e.jsx("p",{className:"text-xs opacity-80",children:"For a faster, full-screen experience."})]}),e.jsx("button",{onClick:i,className:"bg-primary-foreground text-primary font-bold py-1.5 px-4 rounded-md text-sm hover:bg-primary-foreground/90 transition-colors",children:"Install"}),e.jsx("button",{onClick:h,className:"p-1.5 rounded-full hover:bg-primary-foreground/10 transition-colors","aria-label":"Dismiss install banner",children:e.jsx($e,{className:"w-5 h-5"})})]})})},tt=()=>{const[t,i]=m.useState("syncing");m.useEffect(()=>{const p=W(D(f,"inventory"),{includeMetadataChanges:!0},w=>{if(!navigator.onLine){i("offline");return}const v=w.metadata.hasPendingWrites;i(v?"syncing":"synced")},w=>{console.error("Sync error:",w),i("offline")}),x=()=>{i("syncing")},I=()=>i("offline");return window.addEventListener("online",x),window.addEventListener("offline",I),navigator.onLine||i("offline"),()=>{p(),window.removeEventListener("online",x),window.removeEventListener("offline",I)}},[]);const h={synced:{text:"Synced",color:"text-success",Icon:Ue},syncing:{text:"Syncing...",color:"text-info",Icon:ze},offline:{text:"Offline",color:"text-muted-foreground",Icon:ae}},{text:u,color:l,Icon:d}=h[t];return e.jsxs("div",{role:"status","aria-live":"polite","aria-atomic":"true",className:`flex items-center gap-2 text-xs font-medium ${l}`,children:[e.jsx(d,{className:`w-4 h-4 ${t==="syncing"?"animate-pulse":""}`,"aria-hidden":"true"}),e.jsx("span",{children:u}),e.jsxs("span",{className:"sr-only",children:[". Data is currently ",t,"."]})]})},ne=m.lazy(()=>O(()=>import("./DashboardPage-s_6jLgKk.js"),__vite__mapDeps([0,1,2,3,4,5]))),nt=m.lazy(()=>O(()=>import("./TransactionsPage-BhzN8dnt.js"),__vite__mapDeps([6,1,2,5]))),ot=m.lazy(()=>O(()=>import("./InventoryPage-DDLFU6xl.js"),__vite__mapDeps([7,1,2,3,8,5]))),st=m.lazy(()=>O(()=>import("./SettingsPage-QR4r4nje.js"),__vite__mapDeps([9,1,2,3,8,5]))),rt=m.lazy(()=>O(()=>import("./AddTransactionModal-DidbAVrw.js"),__vite__mapDeps([10,1,2,5]))),at=m.lazy(()=>O(()=>import("./EditTransactionModal-Ccz8-wkY.js"),__vite__mapDeps([11,1,2,5]))),it=m.lazy(()=>O(()=>import("./ChangelogModal-DpNsN_D5.js"),__vite__mapDeps([12,1,2,5]))),ct=[{name:"Grower Feeds",price:1500,stock:50,unit:"bag",category:"Feeds",cost:"₱1200/bag",imageUrl:"https://placehold.co/150x150/22c55e/FFFFFF/png?text=Feeds"},{name:"Starter Feeds",price:1800,stock:30,unit:"bag",category:"Feeds",cost:"₱1500/bag",imageUrl:"https://placehold.co/150x150/22c55e/FFFFFF/png?text=Feeds"},{name:"Vitamins",price:250,stock:100,unit:"bottle",category:"Non-Feeds",cost:"₱180/bottle",imageUrl:"https://placehold.co/150x150/3b82f6/FFFFFF/png?text=Vitamins"},{name:"Antibiotics",price:300,stock:4,unit:"bottle",category:"Non-Feeds",cost:"₱220/bottle",imageUrl:"https://placehold.co/150x150/ef4444/FFFFFF/png?text=Meds"}],lt=()=>e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),oe=t=>{if(!t)return null;const i=t.match(/(\d[\d,.]*)/);if(!i)return null;const h=parseFloat(i[1].replace(/,/g,""));if(isNaN(h))return null;const u=t.match(/\s*\/\s*(\d+)/);if(u&&u[1]){const l=parseInt(u[1],10);if(!isNaN(l)&&l>0)return h/l}return h},dt=()=>{const[t,i]=m.useState(k.Dashboard),[h,u]=m.useState(!1),[l,d]=m.useState(null),[p,x]=m.useState(!0),[I,w]=m.useState(!1),[v,b]=m.useState(null),{data:c,loading:C}=Je("settings/main"),{data:M,loading:le}=te(G(D(f,"transactions"),Y("date","desc"))),{data:L,loading:B}=te(G(D(f,"inventory"),Y("name","asc")));m.useEffect(()=>{(async()=>{if(!(C||B))try{if(!c){console.log("No settings found, seeding default settings...");const a={storeName:"Olesco Agrivet Trading",storeLogo:"",profitMarginDivisor:.83,theme:"dark"};await J(y(f,"settings","main"),a)}if((await Oe(D(f,"inventory"))).empty){console.log("Inventory is empty, seeding default items...");const a=A(f);ct.forEach(o=>{const s=y(D(f,"inventory"));a.set(s,o)}),await a.commit()}}catch(r){console.error("Error seeding data:",r)}finally{x(!1)}})()},[C,B,c]),m.useEffect(()=>{if(c!=null&&c.theme){const n=window.document.documentElement;n.classList.remove("light","dark"),n.classList.add(c.theme)}},[c==null?void 0:c.theme]);const de=async n=>{const r=A(f),a=y(D(f,"transactions"));r.set(a,n),n.items&&n.items.length>0&&n.items.forEach(o=>{const s=y(f,"inventory",o.inventoryItemId);let g=0;n.type===N.Income?g=-o.quantity:n.type===N.Expense&&n.expenseSubtype===R.InventoryPurchase&&(g=o.quantity),g!==0&&r.update(s,{stock:K(g)})}),await r.commit()},ue=async n=>{const{id:r,...a}=n;await X(y(f,"transactions",r),a),d(null)},he=async n=>{if(window.confirm("Are you sure you want to delete this transaction? This action will also adjust inventory stock.")){const r=A(f),a=y(f,"transactions",n.id);r.delete(a),n.items&&n.items.length>0&&n.items.forEach(o=>{const s=y(f,"inventory",o.inventoryItemId);let g=0;n.type===N.Income?g=o.quantity:n.type===N.Expense&&n.expenseSubtype===R.InventoryPurchase&&(g=-o.quantity),g!==0&&r.update(s,{stock:K(g)})}),await r.commit()}},me=async n=>{if("id"in n){const{id:r,...a}=n;await X(y(f,"inventory",r),a)}else await Re(D(f,"inventory"),n)},pe=async n=>{window.confirm("Are you sure you want to delete this item? This cannot be undone.")&&await Fe(y(f,"inventory",n))},U=async n=>{await J(y(f,"settings","main"),n,{merge:!0})},fe=async()=>{if(!window.confirm("Are you sure you want to refresh all income transaction names? This will assign new random IDs to them. This can be undone."))return;const n=M.filter(r=>r.type===N.Income&&r.name.startsWith("Point of Sale"));if(n.length===0){alert("No income transactions to refresh.");return}try{const r=A(f),a=n.map(o=>({id:o.id,name:o.name}));n.forEach(o=>{const g=`Point of Sale Transaction #${Math.random().toString(36).substring(2,7)}`,T=y(f,"transactions",o.id);r.update(T,{name:g})}),await r.commit(),b({type:"refreshIncomeNames",description:`Refreshed names for ${n.length} income transactions.`,data:a}),alert(`Successfully refreshed ${n.length} transaction names.`)}catch(r){console.error("Error refreshing transaction names:",r),alert("An error occurred while refreshing transaction names. Please check the console.")}},ge=async()=>{if(window.confirm("This will recalculate all item stocks based on transaction history, overwriting any manual stock edits. This can be undone. Are you sure?"))try{const n=new Map;M.forEach(s=>{s.items&&s.items.forEach(g=>{const T=n.get(g.inventoryItemId)||0;let S=0;s.type===N.Income?S=-g.quantity:s.type===N.Expense&&s.expenseSubtype===R.InventoryPurchase&&(S=g.quantity),n.set(g.inventoryItemId,T+S)})});const r=A(f),a=L.map(s=>({id:s.id,stock:s.stock}));let o=0;L.forEach(s=>{const g=n.get(s.id);if(g!==void 0&&s.stock!==g){const T=y(f,"inventory",s.id);r.update(T,{stock:g}),o++}}),await r.commit(),b({type:"recalculateInventory",description:`Recalculated stock for ${o} items.`,data:a}),alert(`Successfully recalculated stock for ${o} items.`)}catch(n){console.error("Error recalculating inventory:",n),alert("An error occurred. Check the console.")}},xe=async()=>{if(window.confirm(`This will recalculate the price of ALL items based on their cost and the current profit margin divisor (${c==null?void 0:c.profitMarginDivisor}). This can be undone. Are you sure?`))try{const n=c==null?void 0:c.profitMarginDivisor;if(!n||n<=0||n>=1){alert("A valid profit margin divisor (between 0 and 1) is not set. Cannot perform bulk price update.");return}const r=A(f),a=L.map(s=>({id:s.id,price:s.price}));let o=0;if(L.forEach(s=>{const g=oe(s.cost);if(g!==null&&g>0){const T=Math.round(g/n);if(T!==s.price){const S=y(f,"inventory",s.id);r.update(S,{price:T}),o++}}}),o===0){alert("No item prices needed to be updated based on their cost.");return}await r.commit(),b({type:"bulkPriceUpdate",description:`Updated price for ${o} items based on cost and profit margin.`,data:a}),alert(`Successfully updated prices for ${o} items.`)}catch(n){console.error("Error with bulk price update:",n),alert("An error occurred. Check console.")}},we=async()=>{if(window.confirm("This will restock any item with less than 5 stock back to 20. This can be undone. Are you sure?"))try{const n=A(f),r=L.filter(o=>o.stock<5),a=r.map(o=>({id:o.id,stock:o.stock}));if(r.length===0){alert("No items with low stock to update.");return}r.forEach(o=>{const s=y(f,"inventory",o.id);n.update(s,{stock:20})}),await n.commit(),b({type:"bulkStockUpdate",description:`Restocked ${r.length} low-stock items.`,data:a}),alert(`Successfully restocked ${r.length} items.`)}catch(n){console.error("Error with bulk stock update:",n),alert("An error occurred. Check console.")}},ve=()=>{const n=new Set(L.map(o=>o.id)),r=new Set;let a=0;M.forEach(o=>{o.items&&o.items.forEach(s=>{n.has(s.inventoryItemId)||(a++,r.add(o.id))})}),a>0?alert(`Found ${a} item entries in transactions that point to deleted inventory items.
Check transactions with these IDs: ${Array.from(r).slice(0,5).join(", ")}...
This tool is for reporting only and does not delete any data.`):alert("No orphaned transaction data found. Your data is clean!")},ye=()=>{const n=M.reduce((E,P)=>{const j=new Date(P.date).toISOString().split("T")[0];return E[j]||(E[j]=[]),E[j].push(P),E},{}),r=Object.keys(n).sort((E,P)=>new Date(P).getTime()-new Date(E).getTime());let a=`DATE,DESCRIPTION,PRODUCTS,"INCOME (CREDIT)","EXPENSE (DEBIT)"
`,o=0,s=0;const g=new Map(L.map(E=>[E.id,E]));r.forEach(E=>{const P=n[E];P.sort((j,_)=>new Date(_.date).getTime()-new Date(j.date).getTime()),P.forEach((j,_)=>{const Le=_===0?`"${E}"`:'""',Se=`"${(j.name||"").replace(/"/g,'""')}"`;let H="";j.items&&j.items.length>0&&(H=j.items.map(q=>{const $=g.get(q.inventoryItemId);return $?`${q.quantity} ${$.unit||"pcs"} - ${$.name}`:"Unknown Item"}).join(`
`).replace(/"/g,'""'));const Ee=`"${H}"`,Ne=j.type===N.Income?`"${j.amount.toFixed(2)}"`:'"-"',Ce=j.type===N.Expense?`"${j.amount.toFixed(2)}"`:'"-"';a+=`${Le},${Se},${Ee},${Ne},${Ce}
`,j.type===N.Income?o+=j.amount:s+=j.amount})}),a+=`
`,a+=`"",,Total,"${o.toFixed(2)}","${s.toFixed(2)}"`;const T=new Blob([a],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a"),V=URL.createObjectURL(T);S.setAttribute("href",V),S.setAttribute("download",`olesco-cashbook-export-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(V)},ke=()=>{const n={};M.forEach(a=>{a.type!==N.Income||!a.items||a.items.forEach(o=>{const s=L.find(g=>g.id===o.inventoryItemId);if(s){const g=oe(s.cost);if(g!==null){const S=(s.price-g)*o.quantity;n[s.id]||(n[s.id]={name:s.name,profit:0,count:0}),n[s.id].profit+=S,n[s.id].count+=o.quantity}}})});const r=Object.values(n).sort((a,o)=>o.profit-a.profit);if(r.length>0){let a=`Top 3 Most Profitable Items:

`;r.slice(0,3).forEach((o,s)=>{a+=`${s+1}. ${o.name}
`,a+=`   - Total Profit: ${o.profit.toLocaleString("en-PH",{style:"currency",currency:"PHP"})}
`,a+=`   - Units Sold: ${o.count}

`}),alert(a)}else alert('Could not analyze profitability. Ensure items have valid, machine-readable cost information (e.g., "Cost: ₱1200 / 50 bag").')},je=async()=>{if(!v){alert("No action to undo.");return}const{type:n,data:r}=v,a=A(f);try{switch(n){case"recalculateInventory":case"bulkStockUpdate":r.forEach(o=>{const s=y(f,"inventory",o.id);a.update(s,{stock:o.stock})});break;case"bulkPriceUpdate":r.forEach(o=>{const s=y(f,"inventory",o.id);a.update(s,{price:o.price})});break;case"refreshIncomeNames":r.forEach(o=>{const s=y(f,"transactions",o.id);a.update(s,{name:o.name})});break;default:throw new Error("Unknown action type to undo.")}await a.commit(),alert(`Successfully undone: ${v.description}`),b(null)}catch(o){console.error("Error undoing last action:",o),alert("An error occurred while undoing the action. Please check the console.")}},be=n=>{U({theme:n})},F={[k.Dashboard]:{title:"Dashboard"},[k.Transactions]:{title:"Transaction History",subtitle:"Review past sales and expenses."},[k.Inventory]:{title:"Inventory Management"},[k.Settings]:{title:"Settings",subtitle:"Configure your application and store details."}},Ie=()=>{switch(t){case k.Dashboard:return e.jsx(ne,{transactions:M,inventory:L,onNavigate:i});case k.Transactions:return e.jsx(nt,{transactions:M,inventory:L,onDeleteTransaction:he,onEditTransaction:d});case k.Inventory:return e.jsx(ot,{inventory:L,onSaveItem:me,onDeleteItem:pe,profitMarginDivisor:(c==null?void 0:c.profitMarginDivisor)||.8});case k.Settings:return e.jsx(st,{settings:c,onSaveSettings:U,transactions:M,inventory:L,theme:c.theme,setTheme:be,onRefreshIncomeTransactionNames:fe,onRecalculateInventory:ge,onBulkPriceUpdate:xe,onBulkStockUpdate:we,onOrphanedDataCleanup:ve,onGenerateFinancialReport:ye,onProfitabilityAnalysis:ke,lastActionBackup:v,onUndoLastAction:je});default:return e.jsx(ne,{transactions:M,inventory:L,onNavigate:i})}};return p||C||le||B||!c?e.jsxs("div",{className:"w-screen h-screen flex flex-col items-center justify-center bg-background text-foreground gap-4",children:[c&&c.storeLogo?e.jsx("img",{src:c.storeLogo,alt:"Store Logo",className:"w-24 h-24 rounded-full object-cover animate-pulse shadow-lg"}):e.jsx(ee,{className:"w-24 h-24 text-primary animate-pulse"}),e.jsx("p",{className:"text-lg font-semibold tracking-tight",children:"Loading Olesco Feeds Trading..."})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Ke,{}),e.jsx("header",{className:"sticky top-0 z-40 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container flex h-16 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[c.storeLogo?e.jsx("img",{src:c.storeLogo,alt:"Store Logo",className:"w-10 h-10 rounded-lg object-cover flex-shrink-0 bg-secondary"}):e.jsx("div",{className:"w-10 h-10 rounded-lg flex-shrink-0 bg-secondary flex items-center justify-center text-muted-foreground",children:e.jsx(ee,{className:"w-full h-full p-1 opacity-50"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:c.storeName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"POS & Inventory System"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(tt,{})}),e.jsx("button",{onClick:()=>w(!0),className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors p-2 rounded-lg hover:bg-muted","aria-label":"What's new",children:e.jsx(Ve,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>u(!0),className:"hidden md:inline-flex items-center gap-2 bg-primary px-4 py-2 rounded-lg text-primary-foreground hover:bg-primary/90 transition-colors",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"New Sale"})]})]})]})}),e.jsxs("div",{className:"container flex-1 flex gap-8 pt-8",children:[e.jsx("nav",{className:"hidden lg:block w-56",children:e.jsx("div",{className:"space-y-1 sticky top-24",children:Object.entries(F).map(([n,r])=>{const a=n,o=(()=>{switch(a){case k.Dashboard:return z;case k.Transactions:return se;case k.Inventory:return re;case k.Settings:return ie;default:return z}})();return e.jsxs("button",{title:r.title,onClick:()=>i(a),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${t===a?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,children:[e.jsx(o,{className:"w-5 h-5"}),r.title]},n)})})}),e.jsxs("main",{className:"flex-1 min-w-0 pb-20 lg:pb-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:F[t].title}),F[t].subtitle&&e.jsx("p",{className:"text-muted-foreground mt-1",children:F[t].subtitle})]}),e.jsx(m.Suspense,{fallback:e.jsx(lt,{}),children:Ie()})]})]}),e.jsx("button",{onClick:()=>u(!0),className:"fixed lg:hidden bottom-20 right-4 w-14 h-14 bg-primary rounded-full text-primary-foreground shadow-lg flex items-center justify-center hover:bg-primary/90 active:scale-95 transition-all z-40","aria-label":"Add Transaction",children:e.jsx(Q,{className:"w-6 h-6"})}),e.jsx(et,{}),e.jsxs(m.Suspense,{fallback:null,children:[h&&e.jsx(rt,{isOpen:h,onClose:()=>u(!1),onAddTransaction:de,inventory:L}),l&&e.jsx(at,{isOpen:!!l,onClose:()=>d(null),onSave:ue,transactionToEdit:l}),I&&e.jsx(it,{isOpen:I,onClose:()=>w(!1)})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx(qe,{currentPage:t,setCurrentPage:i})})]})},ce=document.getElementById("root");if(!ce)throw new Error("Could not find root element to mount to");const ut=Me.createRoot(ce);ut.render(e.jsx(Te.StrictMode,{children:e.jsx(dt,{})}));export{Lt as C,R as E,It as I,Et as L,Ct as M,k as P,Nt as S,N as T,ze as U,bt as W,kt as a,jt as b,St as c,vt as d,yt as e,xt as f,Mt as g,Tt as h,wt as i,ae as j};
