import{r as a,j as e}from"./vendor-react-DYaHPGH9.js";import{C as l}from"./Card-CJQhyZQC.js";import{S as q,M as V,I as H,U as J,j as K}from"./index-75GWciUF.js";import{u as Q}from"./cloudinary-B-Z19H0V.js";import"./vendor-B_ioZ_iA.js";import"./vendor-firebase-Bk-C1n0P.js";const te=F=>{const{settings:r,onSaveSettings:b,theme:j,setTheme:v,onRefreshIncomeTransactionNames:I,onRecalculateInventory:L,onBulkPriceUpdate:P,onBulkStockUpdate:A,onOrphanedDataCleanup:D,onGenerateFinancialReport:M,onProfitabilityAnalysis:T,lastActionBackup:N,onUndoLastAction:B}=F,[y,k]=a.useState(r.storeName),[d,u]=a.useState(r.storeLogo),[c,C]=a.useState(r.profitMarginDivisor.toString()),[S,x]=a.useState(null),[w,h]=a.useState(!1),[t,m]=a.useState(null),R=a.useRef(null);a.useEffect(()=>{k(r.storeName),u(r.storeLogo),C(r.profitMarginDivisor.toString()),x(null)},[r]);const i=async(s,o)=>{m(o),await s(),m(null)},E=async()=>{m("undo"),await B(),m(null)},O=async()=>{h(!0);let s=d;if(S)try{s=await Q(S)}catch{h(!1);return}b({storeName:y,storeLogo:s}),x(null),h(!1),alert("Store information saved!")},G=()=>{const s=parseFloat(c);!isNaN(s)&&s>0&&s<1?(b({profitMarginDivisor:s}),alert("Profit margin saved!")):alert("Please enter a valid profit margin divisor (a number between 0 and 1).")},W=s=>{var U;const o=(U=s.target.files)==null?void 0:U[0];if(o){x(o);const g=new FileReader;g.onloadend=()=>{u(g.result)},g.readAsDataURL(o)}},$=()=>{const s=parseFloat(c);return!isNaN(s)&&s>0&&s<1?`~${((1-s)*100).toFixed(1)}% profit`:"Invalid divisor"},f="w-full px-3 py-2 bg-background border border-input rounded-md text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",p="block text-sm font-medium text-muted-foreground mb-1.5",z="bg-primary text-primary-foreground font-semibold px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",n="flex-shrink-0 bg-secondary text-secondary-foreground font-semibold py-2 px-4 rounded-lg hover:bg-muted transition-colors border border-border disabled:opacity-50 disabled:cursor-not-allowed";return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx(l,{title:"Appearance",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Theme"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select the theme for the application."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("button",{onClick:()=>v("light"),className:`flex items-center justify-center p-4 rounded-md border-2 transition-colors ${j==="light"?"border-primary bg-primary/10":"border-border bg-secondary hover:border-primary/50"}`,children:[e.jsx(q,{className:"w-6 h-6 mr-2"})," Light"]}),e.jsxs("button",{onClick:()=>v("dark"),className:`flex items-center justify-center p-4 rounded-md border-2 transition-colors ${j==="dark"?"border-primary bg-primary/10":"border-border bg-secondary hover:border-primary/50"}`,children:[e.jsx(V,{className:"w-6 h-6 mr-2"})," Dark"]})]})]})}),e.jsx(l,{title:"Store Information",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"storeName",className:p,children:"Store Name"}),e.jsx("input",{type:"text",id:"storeName",value:y,onChange:s=>k(s.target.value),className:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:p,children:"Store Logo"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0 bg-secondary rounded-md flex items-center justify-center border border-border",children:d?e.jsx("img",{src:d,alt:"Logo Preview",className:"w-full h-full object-cover rounded-md"}):e.jsx(H,{className:"w-10 h-10 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",value:d,onChange:s=>u(s.target.value),placeholder:"Paste image URL here",className:f}),e.jsx("div",{className:"text-center text-muted-foreground text-sm",children:"OR"}),e.jsx("input",{type:"file",ref:R,onChange:W,accept:"image/*",className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=R.current)==null?void 0:s.click()},className:"w-full flex items-center justify-center gap-2 py-2 px-4 bg-secondary border border-border rounded-md hover:bg-muted transition-colors",children:[e.jsx(J,{className:"w-5 h-5"}),e.jsx("span",{children:"Upload File"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:O,className:z,disabled:w,children:w?"Saving...":"Save Changes"})})]})}),e.jsx(l,{title:"Pricing Settings",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profitDivisor",className:p,children:"Profit Margin Divisor"}),e.jsx("input",{type:"number",id:"profitDivisor",value:c,onChange:s=>C(s.target.value),step:"0.01",min:"0.01",max:"0.99",className:f}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Current: ",r.profitMarginDivisor]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["This value is used to calculate selling price (`Cost / Divisor`). A divisor of ",c||"..."," results in a ",$(),"."]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:G,className:"bg-secondary text-secondary-foreground font-semibold py-2 px-4 rounded-lg hover:bg-muted transition-colors border border-border",children:"Save Margin"})})]})}),N&&e.jsx(l,{title:"Undo Last Action",variant:"glass",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Last action:"}),e.jsx("p",{className:"font-semibold",children:N.description})]}),e.jsx("button",{onClick:E,disabled:!!t,className:n,children:t==="undo"?"Undoing...":"Undo"})]})}),e.jsxs(l,{title:"Experimental Features",variant:"secondary",children:[e.jsxs("div",{className:"p-3 mb-4 bg-destructive/10 border border-destructive/20 rounded-lg flex items-center gap-3",children:[e.jsx(K,{className:"w-8 h-8 text-destructive flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-destructive",children:"Warning"}),e.jsx("p",{className:"text-xs text-destructive/80",children:"These tools perform powerful, bulk operations on your data. While some actions can be undone, proceed with caution."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Full Inventory Recalculation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recalculates all item stocks based on your entire transaction history. Overwrites manual stock edits."})]}),e.jsx("button",{onClick:()=>i(L,"recalc"),disabled:!!t,className:n,children:t==="recalc"?"Running...":"Run"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Bulk Price Update"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recalculates selling prices for all items based on their cost and the configured profit margin."})]}),e.jsx("button",{onClick:()=>i(P,"priceUpdate"),disabled:!!t,className:n,children:t==="priceUpdate"?"Running...":"Run"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Bulk Stock Update (Sample)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restocks items with less than 5 units back to 20 units."})]}),e.jsx("button",{onClick:()=>i(A,"stockUpdate"),disabled:!!t,className:n,children:t==="stockUpdate"?"Running...":"Run"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Orphaned Data Check"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Finds transaction items that point to products that have been deleted."})]}),e.jsx("button",{onClick:()=>i(D,"orphan"),disabled:!!t,className:n,children:t==="orphan"?"Running...":"Run Check"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Refresh POS Transaction Names"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Regenerate unique names for all "Point of Sale" transactions. Fixes duplicates.'})]}),e.jsx("button",{onClick:()=>i(I,"refreshNames"),disabled:!!t,className:n,children:t==="refreshNames"?"Refreshing...":"Refresh Names"})]})]})]}),e.jsx(l,{title:"Advanced Reporting",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Generate Financial Report"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Exports a detailed transaction history to a CSV file, similar to the cashbook view, with totals for income and expenses."})]}),e.jsx("button",{onClick:()=>i(M,"financialReport"),disabled:!!t,className:n,children:t==="financialReport"?"Generating...":"Generate"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-card-foreground",children:"Profitability Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Identify the most profitable items based on their cost and sales history."})]}),e.jsx("button",{onClick:()=>i(T,"profitAnalysis"),disabled:!!t,className:n,children:t==="profitAnalysis"?"Analyzing...":"Analyze"})]})]})})]})};export{te as default};
