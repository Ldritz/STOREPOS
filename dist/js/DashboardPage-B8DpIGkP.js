import{T as b,j as e,a as N,b as S,W,P as Y}from"./index-Bcm6VW29.js";import{r as $,a as w,B as C,C as k,X as E,Y as T,T as P,b as f,L as H}from"./charts-BYcMWlQw.js";import{C as p}from"./Card-BtIxapcb.js";import"./vendor-CWc6w16D.js";const X=({data:o})=>{const r=t=>`₱${t.toLocaleString()}`;return e.jsx("div",{className:"w-full h-72 md:h-80",children:e.jsx(w,{children:e.jsxs(C,{data:o,margin:{top:20,right:20,left:0,bottom:5},children:[e.jsx(k,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(E,{dataKey:"name",stroke:"hsl(var(--muted-foreground))",fontSize:12}),e.jsx(T,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickFormatter:r}),e.jsx(P,{cursor:{fill:"hsl(var(--accent))"},contentStyle:{backgroundColor:"hsl(var(--popover))",borderColor:"hsl(var(--border))",borderRadius:"0.5rem",color:"hsl(var(--popover-foreground))"},labelStyle:{fontWeight:"bold"}}),e.jsx(H,{wrapperStyle:{color:"hsl(var(--foreground))"}}),e.jsx(f,{dataKey:"income",fill:"hsl(var(--success))",name:"Income",radius:[4,4,0,0]}),e.jsx(f,{dataKey:"expense",fill:"hsl(var(--warning))",name:"Expense",radius:[4,4,0,0]})]})})})},I=({title:o,amount:r,Icon:t,iconClass:n})=>e.jsxs("div",{className:"bg-card border border-border p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:o}),e.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-foreground mt-1",children:r.toLocaleString("en-PH",{style:"currency",currency:"PHP"})})]}),e.jsx("div",{className:`p-3 rounded-md ${n}`,children:e.jsx(t,{className:"w-8 h-8"})})]}),B=({inventory:o,onNavigate:r})=>{const t=o.filter(n=>n.stock<=5);return e.jsx(p,{title:"Low Stock Alerts",actions:e.jsx("button",{onClick:()=>r(Y.Inventory),className:"text-sm text-primary font-semibold hover:underline",children:"Manage →"}),children:t.length>0?e.jsx("div",{className:"h-72 overflow-y-auto pr-2",children:e.jsx("ul",{className:"space-y-2",children:t.slice(0,5).map(n=>e.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-secondary rounded-md",children:[e.jsx("span",{className:"text-secondary-foreground",children:n.name}),e.jsxs("span",{className:"font-bold text-destructive",children:[n.stock," ",n.unit," left"]})]},n.id))})}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx("p",{className:"font-semibold",children:"No low stock items."}),e.jsx("p",{className:"text-sm",children:"Well done!"})]})})},F=({data:o})=>{const r=t=>`₱${t.toLocaleString()}`;return e.jsx(p,{title:"Top 5 Products by Revenue",children:e.jsx("div",{className:"w-full h-72",children:o.length>0?e.jsx(w,{children:e.jsxs(C,{layout:"vertical",data:o,margin:{top:5,right:20,left:20,bottom:5},children:[e.jsx(k,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(E,{type:"number",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickFormatter:r}),e.jsx(T,{type:"category",dataKey:"name",stroke:"hsl(var(--muted-foreground))",fontSize:12,width:100,tickFormatter:t=>t.length>12?`${t.substring(0,12)}...`:t,tick:{textAnchor:"end"}}),e.jsx(P,{cursor:{fill:"hsl(var(--accent))"},contentStyle:{backgroundColor:"hsl(var(--popover))",borderColor:"hsl(var(--border))",borderRadius:"0.5rem",color:"hsl(var(--popover-foreground))"},formatter:t=>r(t)}),e.jsx(f,{dataKey:"revenue",name:"Revenue",fill:"hsl(var(--info))",radius:[0,4,4,0],barSize:20})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground text-center",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"No sales data available."}),e.jsx("p",{className:"text-sm",children:"Sell some products to see top performers!"})]})})})})},h=({title:o,amount:r,Icon:t,iconClass:n})=>e.jsxs("div",{className:"bg-card border border-border p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium uppercase",children:o}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:r.toLocaleString("en-PH",{style:"currency",currency:"PHP"})})]}),e.jsx("div",{className:`p-3 rounded-md ${n}`,children:e.jsx(t,{className:"w-6 h-6"})})]}),V=({transactions:o,inventory:r,onNavigate:t})=>{const{todaysIncome:n,todaysExpenses:D,totalIncome:L,totalExpenses:A,netIncome:O,chartData:g,topProductsData:M}=$.useMemo(()=>{const R=new Date().toISOString().split("T")[0];let j=0,v=0,x=0,u=0;const a={},d={};o.forEach(s=>{const c=s.date.startsWith(R);s.type===b.Income?(x+=s.amount,c&&(j+=s.amount),s.items&&s.items.forEach(y=>{const l=r.find(m=>m.id===y.inventoryItemId);if(l){const m=l.price*y.quantity;d[l.id]?d[l.id].revenue+=m:d[l.id]={name:l.name,revenue:m}}})):(u+=s.amount,c&&(v+=s.amount));const i=new Date(s.date).toLocaleString("default",{month:"short",year:"numeric"});a[i]||(a[i]={income:0,expense:0}),s.type===b.Income?a[i].income+=s.amount:a[i].expense+=s.amount});const z=Object.keys(a).sort((s,c)=>new Date(s).getTime()-new Date(c).getTime()).slice(-6).map(s=>({name:new Date(s).toLocaleString("default",{month:"short"}),...a[s]})),K=Object.values(d).sort((s,c)=>c.revenue-s.revenue).slice(0,5).reverse();return{todaysIncome:j,todaysExpenses:v,totalIncome:x,totalExpenses:u,netIncome:x-u,chartData:z,topProductsData:K}},[o,r]);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(I,{title:"TODAY'S INCOME",amount:n,Icon:N,iconClass:"bg-success text-success-foreground"}),e.jsx(I,{title:"TODAY'S EXPENSES",amount:D,Icon:S,iconClass:"bg-warning text-warning-foreground"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[e.jsx(B,{inventory:r,onNavigate:t}),e.jsx(F,{data:M})]}),e.jsx(p,{title:"Monthly Performance",children:g.length>0?e.jsx(X,{data:g}):e.jsxs("div",{className:"h-full flex flex-col justify-center items-center text-center py-10 text-muted-foreground",children:[e.jsx("p",{className:"font-semibold",children:"No transaction data for chart."}),e.jsx("p",{className:"text-sm",children:"Add some transactions to get started!"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{title:"TOTAL INCOME",amount:L,Icon:N,iconClass:"bg-success text-success-foreground"}),e.jsx(h,{title:"TOTAL EXPENSES",amount:A,Icon:S,iconClass:"bg-warning text-warning-foreground"}),e.jsx(h,{title:"NET INCOME",amount:O,Icon:W,iconClass:"bg-info text-info-foreground"})]})]})};export{V as default};
