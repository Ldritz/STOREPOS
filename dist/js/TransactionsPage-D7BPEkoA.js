import{T as g,j as e,L as M,c as O,C as P,d as $}from"./index-Bcm6VW29.js";import{r as b,R as H}from"./charts-BYcMWlQw.js";import"./vendor-CWc6w16D.js";const m=(r,d=!1)=>(d?Math.abs(r):r).toLocaleString("en-PH",{style:"currency",currency:"PHP"}),v=({title:r,value:d,avg:i})=>e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:r}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:m(d)}),i!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["avg ",m(i),"/day"]})]}),S=({title:r,stats:d})=>e.jsxs("div",{className:"bg-card border border-border p-4 sm:p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-bold text-card-foreground mb-4",children:r}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(v,{title:`Today's ${r.split(" ")[0]}`,value:d.today}),e.jsx(v,{title:"This Week",value:d.thisWeek,avg:d.avgWeek}),e.jsx(v,{title:"All Time",value:d.allTime,avg:d.avgAllTime})]})]}),R=({data:r,sortedDateKeys:d})=>e.jsx("div",{className:"bg-card border border-border rounded-lg overflow-hidden animate-fade-in",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-muted-foreground",children:[e.jsx("thead",{className:"text-xs text-muted-foreground uppercase bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3",children:"Date"}),e.jsx("th",{scope:"col",className:"px-4 py-3 min-w-[250px]",children:"Description"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"Income (Credit)"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"Expense (Debit)"})]})}),e.jsx("tbody",{children:d.length>0?d.map(i=>{const f=r[i];return e.jsxs(H.Fragment,{children:[f.transactions.map((p,y)=>e.jsxs("tr",{className:"border-b border-border hover:bg-muted",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground whitespace-nowrap",children:y===0?new Date(i+"T00:00:00").toLocaleDateString("en-CA"):""}),e.jsx("td",{className:"px-4 py-3",children:p.description}),e.jsx("td",{className:"px-4 py-3 text-right font-mono text-success",children:p.income?m(p.income):"-"}),e.jsx("td",{className:"px-4 py-3 text-right font-mono text-warning",children:p.expense?m(p.expense):"-"})]},p.id)),e.jsxs("tr",{className:"bg-secondary border-b-2 border-border",children:[e.jsx("td",{colSpan:2,className:"px-4 py-2 text-right font-bold text-foreground",children:"Total"}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-success",children:m(f.totalIncome)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-warning",children:m(f.totalExpense)})]})]},i)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"text-center py-16 text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-lg",children:"No transactions found."}),e.jsx("p",{children:"Try changing the filter."})]})})})]})})}),U=({transactions:r,onDeleteTransaction:d})=>{const[i,f]=b.useState("ALL"),[p,y]=b.useState("list"),{incomeStats:E,expenseStats:I}=b.useMemo(()=>{const t=new Date,l=t.toISOString().split("T")[0],n=new Date(t);n.setDate(t.getDate()-6),n.setHours(0,0,0,0);let s=0,o=0,a=0,x=0,h=0,u=0,N=null;[...r].sort((c,j)=>new Date(c.date).getTime()-new Date(j.date).getTime()).forEach(c=>{const j=new Date(c.date);N||(N=j),c.type===g.Income?(a+=c.amount,c.date.startsWith(l)&&(s+=c.amount),j>=n&&(o+=c.amount)):(u+=c.amount,c.date.startsWith(l)&&(x+=c.amount),j>=n&&(h+=c.amount))});const D=N?Math.ceil((t.getTime()-N.getTime())/(1e3*3600*24)):1,k=D>0?D:1;return{incomeStats:{today:s,thisWeek:o,allTime:a,avgWeek:o/7,avgAllTime:a/k},expenseStats:{today:x,thisWeek:h,allTime:u,avgWeek:h/7,avgAllTime:u/k}}},[r]),{groupedCashbookData:C,sortedCashbookDateKeys:A}=b.useMemo(()=>{const t={};r.filter(s=>i==="ALL"||s.type===i).forEach(s=>{const o=s.date.split("T")[0];t[o]||(t[o]={transactions:[],totalIncome:0,totalExpense:0}),t[o].transactions.push({id:s.id,description:s.description,income:s.type===g.Income?s.amount:null,expense:s.type===g.Expense?s.amount:null}),s.type===g.Income?t[o].totalIncome+=s.amount:t[o].totalExpense+=s.amount});for(const s in t)t[s].transactions.sort((o,a)=>{const x=r.find(u=>u.id===o.id),h=r.find(u=>u.id===a.id);return new Date(x.date).getTime()-new Date(h.date).getTime()});const n=Object.keys(t).sort((s,o)=>new Date(o).getTime()-new Date(s).getTime());return{groupedCashbookData:t,sortedCashbookDateKeys:n}},[r,i]),T=b.useMemo(()=>r.filter(t=>i==="ALL"||t.type===i).reduce((t,l)=>{const n=l.date.split("T")[0];return t[n]||(t[n]=[]),t[n].push(l),t},{}),[r,i]),w=Object.keys(T).sort((t,l)=>new Date(l).getTime()-new Date(t).getTime()),L=t=>{const l=new Date,n=new Date;n.setDate(l.getDate()-1);const s=new Date(t+"T00:00:00");return s.toDateString()===l.toDateString()?"TODAY":s.toDateString()===n.toDateString()?"YESTERDAY":s.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})},W=[{label:"All",value:"ALL"},{label:"Sales",value:g.Income},{label:"Expenses",value:g.Expense}];return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(S,{title:"Income Overview",stats:E}),e.jsx(S,{title:"Expense Overview",stats:I})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-border",children:[e.jsx("div",{className:"flex space-x-6",children:W.map(t=>e.jsx("button",{onClick:()=>f(t.value),className:`py-2 font-semibold transition-colors ${i===t.value?"text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground"}`,children:t.label},t.value))}),e.jsxs("div",{className:"flex items-center gap-1 bg-secondary p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>y("list"),className:`p-1.5 rounded-md transition-colors ${p==="list"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,"aria-label":"List View",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>y("cashbook"),className:`p-1.5 rounded-md transition-colors ${p==="cashbook"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,"aria-label":"Cashbook View",children:e.jsx(O,{className:"w-5 h-5"})})]})]}),p==="list"?e.jsx("div",{className:"space-y-6 animate-fade-in",children:w.length>0?w.map(t=>{const l=T[t],n=l.filter(a=>a.type===g.Income).reduce((a,x)=>a+x.amount,0),s=l.filter(a=>a.type===g.Expense).reduce((a,x)=>a+x.amount,0),o=n-s;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-px flex-1 bg-border"}),e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider",children:L(t)}),e.jsx("div",{className:"h-px flex-1 bg-border"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center bg-card border border-border p-3 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground block",children:"INCOME"}),e.jsx("span",{className:"font-bold text-success",children:m(n)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground block",children:"EXPENSES"}),e.jsx("span",{className:"font-bold text-warning",children:m(s)})]}),e.jsx("div",{children:e.jsxs("span",{className:`font-bold ${o<0?"text-destructive":"text-info"}`,children:[e.jsx("span",{className:"text-xs text-muted-foreground block",children:"NET"}),m(o)]})})]}),e.jsx("div",{className:"space-y-2",children:l.map(a=>{var x;return e.jsxs("div",{className:"bg-card border border-border p-4 rounded-lg flex justify-between items-center group",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("p",{className:"font-bold text-foreground truncate",children:a.description}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(a.date).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[a.type===g.Income?e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-lg text-success",children:m(a.amount)}),a.items&&a.items.length>0&&e.jsxs("div",{className:"flex items-center justify-end gap-1 text-muted-foreground",children:[e.jsxs("span",{className:"text-xs",children:[((x=a.items)==null?void 0:x.reduce((h,u)=>h+u.quantity,0))||1," item(s)"]}),e.jsx(P,{className:"w-4 h-4"})]})]}):e.jsx("p",{className:"font-bold text-lg text-warning",children:m(a.amount)}),e.jsx("button",{onClick:()=>d(a),className:"text-muted-foreground hover:text-destructive transition-colors opacity-0 group-hover:opacity-100",children:e.jsx($,{className:"w-5 h-5"})})]})]},a.id)})})]},t)}):e.jsxs("div",{className:"text-center py-16 text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-lg",children:"No transactions found."}),e.jsx("p",{children:"Try changing the filter or adding a new transaction."})]})}):e.jsx(R,{data:C,sortedDateKeys:A})]})};export{U as default};
