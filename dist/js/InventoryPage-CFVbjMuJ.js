import{j as e,e as A,I as Q,E as H,d as z,f as G,U as Y}from"./index-Bcm6VW29.js";import{r as n}from"./charts-BYcMWlQw.js";import{C as D}from"./Card-BtIxapcb.js";import"./vendor-CWc6w16D.js";const J=({isOpen:t,onClose:i,onSave:p,itemToEdit:r,profitMarginDivisor:c})=>{const[u,N]=n.useState(""),[v,f]=n.useState(""),[C,b]=n.useState(""),[x,a]=n.useState("pcs"),[l,h]=n.useState("Feeds"),[q,P]=n.useState(""),[y,k]=n.useState(""),[w,S]=n.useState(""),[F,U]=n.useState(""),L=n.useRef(null),j=!r,I=n.useMemo(()=>{const s=parseFloat(w),o=parseInt(F,10);if(j&&s>0&&o>0&&c>0){const g=s/o;return Math.round(g/c)}return 0},[w,F,j,c]),R=n.useMemo(()=>c>0&&c<1?((1-c)*100).toFixed(1):0,[c]);if(n.useEffect(()=>{t&&(r?(N(r.name),f(r.price.toString()),b(r.stock.toString()),a(r.unit),h(r.category||"Feeds"),P(r.cost||""),k(r.imageUrl||""),S(""),U("")):(N(""),f(""),b(""),a("pcs"),h("Feeds"),P(""),k(""),S(""),U("")))},[r,t]),!t)return null;const B=s=>{var g;const o=(g=s.target.files)==null?void 0:g[0];if(o){const $=new FileReader;$.onloadend=()=>{k($.result)},$.readAsDataURL(o)}},M=s=>{if(s.preventDefault(),j){const o=parseInt(F,10);u&&x&&I>0&&o>0&&(p({name:u,price:I,stock:o,unit:x,category:l,cost:`Cost: ₱${parseFloat(w).toLocaleString()} / ${o} ${x}`,imageUrl:y}),i())}else{const o=parseFloat(v),g=parseInt(C,10);u&&x&&!isNaN(o)&&!isNaN(g)&&r&&(p({...r,name:u,price:Math.round(o),stock:g,unit:x,category:l,cost:q,imageUrl:y}),i())}},m="w-full px-3 py-2 bg-background border border-border rounded-md text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",O=`${m} appearance-none`,d="block text-sm font-medium text-muted-foreground mb-1.5";return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex justify-center items-center z-50 animate-fade-in p-4",children:e.jsxs("div",{className:"bg-card rounded-lg border border-border shadow-xl w-full max-w-lg animate-slide-in-up max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-card-foreground",children:j?"Add New Product":"Edit Product"}),e.jsx("button",{onClick:i,className:"text-muted-foreground hover:text-foreground",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:M,className:"p-6 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:d,children:"Product Name"}),e.jsx("input",{type:"text",id:"name",value:u,onChange:s=>N(s.target.value),required:!0,placeholder:"e.g. Grower Pellets",className:m})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:d,children:"Category"}),e.jsxs("select",{id:"category",value:l,onChange:s=>h(s.target.value),className:O,children:[e.jsx("option",{children:"Feeds"}),e.jsx("option",{children:"Non-Feeds"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unit",className:d,children:"Unit"}),e.jsxs("select",{id:"unit",value:x,onChange:s=>a(s.target.value),required:!0,className:O,children:[e.jsx("option",{children:"kilo"}),e.jsx("option",{children:"pcs"}),e.jsx("option",{children:"pack"}),e.jsx("option",{children:"bottle"}),e.jsx("option",{children:"box"}),e.jsx("option",{children:"sachet"})]})]})]}),j?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"batchCost",className:d,children:"Batch Cost"}),e.jsx("input",{type:"number",id:"batchCost",value:w,onChange:s=>S(s.target.value),required:!0,min:"0",step:"any",placeholder:"e.g., 1000",className:m})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"batchQuantity",className:d,children:"Quantity in Batch"}),e.jsx("input",{type:"number",id:"batchQuantity",value:F,onChange:s=>U(s.target.value),required:!0,min:"1",step:"1",placeholder:"e.g., 50",className:m})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:d,children:"Price"}),e.jsx("input",{type:"number",id:"price",value:v,onChange:s=>f(s.target.value),required:!0,min:"0",step:"1",className:m})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stock",className:d,children:"Stock Quantity"}),e.jsx("input",{type:"number",id:"stock",value:C,onChange:s=>b(s.target.value),required:!0,min:"0",step:"1",className:m})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cost",className:d,children:"Cost Details (Optional)"}),e.jsx("input",{type:"text",id:"cost",value:q,onChange:s=>P(s.target.value),placeholder:"e.g. Cost: P543 / 12 pack",className:m})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:d,children:"Product Image (Optional)"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0 bg-secondary rounded-md flex items-center justify-center border border-border",children:y?e.jsx("img",{src:y,alt:"Product Preview",className:"w-full h-full object-cover rounded-md"}):e.jsx(Q,{className:"w-10 h-10 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",value:y,onChange:s=>k(s.target.value),placeholder:"Paste image URL here",className:m}),e.jsx("div",{className:"text-center text-muted-foreground text-sm",children:"OR"}),e.jsx("input",{type:"file",ref:L,onChange:B,accept:"image/*",className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=L.current)==null?void 0:s.click()},className:"w-full flex items-center justify-center gap-2 py-2 px-4 bg-secondary border border-border rounded-md hover:bg-muted transition-colors",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{children:"Upload File"})]})]})]})]}),j&&e.jsxs("div",{className:"bg-secondary border border-border rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Calculated Selling Price (per item)"}),e.jsx("p",{className:"text-3xl font-bold text-success my-1",children:I>0?I.toLocaleString("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:0}):"₱0"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Based on a ~",R,"% profit margin."]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:i,className:"bg-secondary text-secondary-foreground font-bold py-2 px-6 rounded-lg hover:bg-muted transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-primary text-primary-foreground font-bold py-2 px-6 rounded-lg hover:bg-primary/90 transition-colors",children:"Save Product"})]})]})]})})},K=({item:t,onEdit:i,onDelete:p})=>{const r=t.stock<=5,c=r?"bg-destructive/20 text-destructive":"bg-success/20 text-success";return e.jsxs("div",{className:`bg-card border border-border rounded-lg p-4 flex gap-4 relative transition-all duration-300 hover:shadow-lg hover:-translate-y-1 ${r?"ring-2 ring-destructive":""}`,children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover rounded-md bg-secondary"}):e.jsx("div",{className:"w-full h-full bg-secondary rounded-md flex items-center justify-center border border-border",children:e.jsx(Q,{className:"w-10 h-10 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("p",{className:"text-lg font-bold text-card-foreground",children:t.name}),r&&t.stock>0&&e.jsx("span",{className:"text-xs font-bold uppercase text-warning ml-2",children:"Low"})]}),e.jsx("p",{className:"text-xl font-bold text-success mt-1",children:t.price.toLocaleString("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:0})}),t.cost&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.cost}),e.jsx("div",{className:`mt-3 inline-block px-3 py-1 text-sm font-semibold rounded-full ${c}`,children:t.stock>0?`${t.stock} ${t.unit} in stock`:"Out of stock"})]}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[e.jsx("button",{onClick:()=>i(t),className:"p-2 rounded-full bg-secondary/50 text-muted-foreground hover:bg-info hover:text-info-foreground transition-colors",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(t.id),className:"p-2 rounded-full bg-secondary/50 text-muted-foreground hover:bg-destructive hover:text-destructive-foreground transition-colors",children:e.jsx(z,{className:"w-4 h-4"})})]})]})},_=({inventory:t,onSaveItem:i,onDeleteItem:p,profitMarginDivisor:r})=>{const[c,u]=n.useState(!1),[N,v]=n.useState(null),f=a=>{v(a||null),u(!0)},C=()=>{u(!1),v(null)},b=n.useMemo(()=>t.reduce((a,l)=>{const h=l.category||"Non-Feeds";return a[h]||(a[h]=[]),a[h].push(l),a},{}),[t]),x=Object.keys(b).sort((a,l)=>a==="Feeds"?-1:l==="Feeds"?1:a.localeCompare(l));return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>f(),className:"flex items-center gap-2 bg-primary text-primary-foreground font-bold py-2 px-4 rounded-lg hover:bg-primary/90 transition-colors",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Item"})]})}),t.length>0?x.map(a=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground mb-4",children:a}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:b[a].map(l=>e.jsx(K,{item:l,onEdit:f,onDelete:p},l.id))})]},a)):e.jsx(D,{className:"text-center py-16",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-lg",children:"Your inventory is empty."}),e.jsx("p",{className:"mt-2",children:'Click "Add Item" to get started.'})]})}),e.jsx(J,{isOpen:c,onClose:C,onSave:i,itemToEdit:N,profitMarginDivisor:r})]})};export{_ as default};
